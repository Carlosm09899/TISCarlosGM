<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Membresía BD</title>
    <link rel="stylesheet" href="./../styles/style_BD.css">
</head>
<body>

    <header>
        <h1>Diseño de la Base de Datos: Membresía</h1>
    </header>

    <div class="container">

        <div class="section">
            <a href="./../Submodulos/Membresia.html">[Regresar a Membresía]</a>
        </div>

        <div class="section">
            <h2>Diagrama de la base de datos</h2>
            
            <img src="./../Imagenes/Diagrama_Membresi.png" alt="Diagrama de la base de datos" style="width: 100%; max-width: 800px;">
        </div>

        <div class="section">
            <h2>Descripción de Pertinencia de la Arquitectura</h2>

            <h3>Tabla Perfil Miembro</h3>
            <h4>Propósito</h4>
            <p>Es la tabla central que guarda la información personal y de contacto de cada persona registrada.</p>
            <h4>Campos</h4>
            <ul>
                <li><b>ID_Miembro:</b> Un número de identificación único para cada persona.</li>
                <li><b>Nombre, Apellidos, Fecha_Nacimiento:</b> Datos personales básicos.</li>
                <li><b>Correo_Electronico, Numero_Telefono:</b> Datos de contacto.</li>
                <li><b>Contraseña:</b> Almacena de forma segura la contraseña del cliente.</li>
                <li><b>Fecha_Registro:</b> Cuándo se inscribió la persona.</li>
            </ul>

            <h3>Tabla Niveles de Membresía</h3>
            <h4>Propósito</h4>
            <p>Funciona como un catálogo que define los únicos tipos de membresía que tu negocio ofrece.</p>
            <h4>Campos</h4>
            <ul>
                <li><b>ID_Nivel:</b> Un número único para cada nivel (ej. 1, 2, 3).</li>
                <li><b>Nombre_Nivel:</b> El nombre del nivel (ej. 'Bronce', 'Plata', 'Oro').</li>
            </ul>

            <h3>Tabla Beneficios</h3>
            <h4>Propósito</h4>
            <p>Es otro catálogo que describe cada uno de los beneficios o ventajas que se pueden ofrecer.</p>
            <h4>Campos</h4>
            <ul>
                <li><b>ID_Beneficio:</b> Un número único para cada beneficio.</li>
                <li><b>Descripcion_Beneficio:</b> El texto que explica el beneficio (ej. 'Acceso gratuito al spa').</li>
                <li><b>Condiciones_Beneficio:</b> La "letra pequeña" del beneficio (ej. 'Sujeto a disponibilidad').</li>
            </ul>

            <h3>Tabla Nivel del Beneficio</h3>
            <h4>Propósito</h4>
            <p>Su única y más importante función es conectar o unir los niveles con sus beneficios.</p>
            <h4>Campos</h4>
            <ul>
                <li><b>ID_Nivel:</b> El número del nivel.</li>
                <li><b>ID_Beneficio:</b> El número del beneficio.</li>
            </ul>

            <h3>Tabla Membresía</h3>
            <h4>Propósito</h4>
            <p>Vincula a un miembro específico con un nivel de membresía y gestiona su estado actual.</p>
            <h4>Campos</h4>
            <ul>
                <li><b>ID_Miembro:</b> Para saber de quién es la membresía.</li>
                <li><b>ID_Nivel:</b> Para saber qué nivel tiene esa persona.</li>
                <li><b>Estado_Membresia:</b> Para saber si está 'Activa' o 'Vencida'.</li>
                <li><b>Fecha_Vencimiento:</b> La fecha de caducidad de su membresía.</li>
                <li><b>Puntos_Acumulados:</b> El total de puntos que tiene el miembro.</li>
            </ul>

            <h3>Tabla Historial Visitas</h3>
            <h4>Propósito</h4>
            <p>Funciona como una bitácora que registra cada visita que un miembro realiza.</p>
            <h4>Campos</h4>
            <ul>
                <li><b>ID_Miembro:</b> Para saber quién realizó la visita.</li>
                <li><b>Fecha_Visita:</b> Cuándo fue al Hotel.</li>
                <li><b>Gasto_Total_Visita:</b> Cuánto dinero gastó en cada visita.</li>
                <li><b>Habitacion_Ocupada, Servicios_Consumidos:</b> Detalles de la visita.</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Normalización de la Base de Datos</h2>
            <p>Para asegurar que los datos estén bien organizados y sean consistentes, la base de datos se estructuró siguiendo las tres primeras formas normales (1FN, 2FN y 3FN).</p>

            <h3>1NF (Primera Forma Normal)</h3>
            <p>Cada tabla tiene una clave primaria única y todas las columnas son atómicas (almacenan un solo valor).</p>
            
            <h3>2NF (Segunda Forma Normal)</h3>
            <p>La tabla está en 1NF y todos los atributos que no son clave dependen completamente de la clave primaria completa.</p>

            <h3>3NF (Tercera Forma Normal)</h3>
            <p>La tabla está en 2NF y ningún atributo que no sea clave depende de otro atributo que tampoco sea clave, eliminando dependencias indirectas.</p>

            <p>Esta estructura de datos es eficiente porque minimiza la repetición de información y hace que la gestión de la base de datos sea mucho más sencilla.</p>
        </div>

        <div class="section">
            <h2>Código SQL para Crear Tablas</h2>
            <pre><code>CREATE DATABASE Membresias;
USE Membresias;

CREATE TABLE Perfil_Miembro (
    ID_Miembro INT PRIMARY KEY IDENTITY(1,1),
    Nombre NVARCHAR(100) NOT NULL,
    Apellido_P NVARCHAR(100) NOT NULL,
    Apellido_M NVARCHAR(100),
    Fecha_Nacimiento DATE,
    Correo_Electronico NVARCHAR(255) NOT NULL UNIQUE,
    Numero_Telefono NVARCHAR(20),
    Fecha_Registro DATETIME DEFAULT GETDATE()
);
GO

CREATE TABLE Niveles_Membresia (
    ID_Nivel INT PRIMARY KEY IDENTITY(1,1),
    Nombre_Nivel VARCHAR(50) NOT NULL UNIQUE
);
GO

CREATE TABLE Beneficios (
    ID_Beneficio INT PRIMARY KEY IDENTITY(1,1),
    Descripcion_Beneficio NVARCHAR(MAX) NOT NULL,
    Condiciones_Beneficio NVARCHAR(MAX)
);
GO

CREATE TABLE Membresia (
    ID_Membresia INT PRIMARY KEY IDENTITY(1,1),
    ID_Miembro INT NOT NULL,
    ID_Nivel INT NOT NULL, 
    Estado_Membresia VARCHAR(10) NOT NULL,
    Fecha_Vencimiento DATE NOT NULL,
    Puntos_Acumulados INT DEFAULT 0,
    
    CONSTRAINT CHK_Membresia_Estado CHECK (Estado_Membresia IN('Activa', 'Inactiva', 'Vencida')),
    FOREIGN KEY (ID_Miembro) REFERENCES Perfil_Miembro(ID_Miembro) ON DELETE CASCADE,
    FOREIGN KEY (ID_Nivel) REFERENCES Niveles_Membresia(ID_Nivel)
);
GO

CREATE TABLE Nivel_Beneficio (
    ID_Nivel INT NOT NULL,
    ID_Beneficio INT NOT NULL,
    PRIMARY KEY (ID_Nivel, ID_Beneficio), 
    FOREIGN KEY (ID_Nivel) REFERENCES Niveles_Membresia(ID_Nivel) ON DELETE CASCADE,
    FOREIGN KEY (ID_Beneficio) REFERENCES Beneficios(ID_Beneficio) ON DELETE CASCADE
);
GO

CREATE TABLE Historial_Visitas (
    ID_Visita INT PRIMARY KEY IDENTITY(1,1),
    ID_Miembro INT NOT NULL,
    Fecha_Visita DATETIME DEFAULT GETDATE(),
    Gasto_Total_Visita DECIMAL(10, 2) DEFAULT 0.00,
    Habitacion_Ocupada VARCHAR(10),
    Servicios_Consumidos NVARCHAR(MAX),
    Promocion_Canjeada NVARCHAR(255),
    FOREIGN KEY (ID_Miembro) REFERENCES Perfil_Miembro(ID_Miembro) ON DELETE CASCADE
);
GO</code></pre>
        </div>

        <div class="section">
            <h2>Código SQL para Agregar Registros</h2>
            <h3>Registro de Niveles de Membresía</h3>
            <pre><code>INSERT INTO Niveles_Membresia (Nombre_Nivel) VALUES
('Bronce'), ('Plata'), ('Oro'), ('Platino');</code></pre>

            <h3>Registro de Beneficios</h3>
            <pre><code>INSERT INTO Beneficios (Descripcion_Beneficio, Condiciones_Beneficio) VALUES
('Bebida de cortesía en el lobby', 'Una por estancia.'),
('Acceso a la alberca principal', 'Horario de 9 AM a 8 PM.'),
('Wi-Fi estándar gratuito', 'Hasta 2 dispositivos.'),
('10% de descuento en restaurante', 'No aplica con otras promociones.'),
('Acumulación de puntos x1.25', 'Puntos extra por cada compra.'),
('Wi-Fi de alta velocidad', 'Dispositivos ilimitados.'),
('Late check-out hasta las 2 PM', 'Sujeto a disponibilidad.'),
('Acceso al gimnasio 24 horas', 'Uso exclusivo para miembros Plata o superior.'),
('Upgrade de habitación a vista preferencial', 'Sujeto a disponibilidad.'),
('Desayuno continental incluido', 'Para dos personas.'),
('Acceso a eventos exclusivos', 'Requiere reservación.'),
('Servicio de estacionamiento gratuito', 'Un vehículo por habitación.'),
('Upgrade a Suite Junior garantizado', 'Al reservar habitación estándar.'),
('Servicio de mayordomo personal', 'Requiere solicitud con 24h de antelación.'),
('Transporte Aeropuerto-Hotel de lujo', 'Viaje redondo.');</code></pre>

            <h3>Registro de Perfil Miembro</h3>
            <pre><code>INSERT INTO Perfil_Miembro (Nombre, Apellido_P, Apellido_M, Fecha_Nacimiento, Correo_Electronico, Numero_Telefono) VALUES
('Ana', 'García', 'López', '1990-05-15', 'ana.garcia@email.com', '5512345678'),
('Luis', 'Martínez', 'Hernández', '1985-11-22', 'luis.martinez@email.com', '5587654321'),
-- (rest of the member data...)
('Paulina', 'Vega', 'Lara', '1997-11-01', 'paulina.vega@email.com', '5590909090');</code></pre>
        </div>
    </div>

</body>
</html>